---
name: bdd-step-type-semantics
description: Семантика BDD степов - только Then требует assertions
alwaysApply: true
---

# BDD Step Type Semantics

В BDD (Gherkin) каждый тип степа имеет свою семантику. **Только Then требует assertions**.

## Семантика

| Тип | Назначение | Требует assertion? |
|-----|------------|-------------------|
| Given | Setup — подготовка данных | ❌ Нет |
| When | Action — выполнение действия | ❌ Нет |
| Then | Assertion — проверка результата | ✅ Да |
| And/But | Наследует тип предыдущего степа | Зависит |

## Правильно

```csharp
// Given — setup, assertions НЕ нужны
[Given(@"user exists")]
public void GivenUserExists()
{
    _user = new User("test"); // Просто setup
}

// When — action, assertions НЕ нужны
[When(@"user logs in")]
public async Task WhenUserLogsIn()
{
    await _loginService.Login(_user); // Просто действие
}

// Then — assertion ОБЯЗАТЕЛЕН
[Then(@"user should be authenticated")]
public void ThenUserAuthenticated()
{
    Assert.True(_user.IsAuthenticated); // ✅ Есть assertion
}
```

## Неправильно

```csharp
// ❌ Флаговать Given как BAD из-за отсутствия assertion
[Given(@"database is empty")]
public void GivenDatabaseEmpty()
{
    _db.Clear(); // Это нормально — Given не требует assertion
}
```

## Чеклист

- [ ] При валидации степов — учитывать тип (Given/When/Then)
- [ ] And/But — определять тип по предыдущему степу
- [ ] Assertions требовать только для Then
